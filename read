import subprocess
import re

def read_pci_register(bus, register):
    try:
        register_output = subprocess.check_output(["setpci", "-s", bus, register])
        print(f"Value at register {register} for {bus}: {register_output.decode().strip()}")
    except subprocess.CalledProcessError:
        print(f"Error reading register {register} for {bus}.")

def read_bridge_control(bus):
    try:
        bridge_control_output = subprocess.check_output(["setpci", "-s", bus, "3e.w"])
        print(f"Bridge Control for {bus}: {bridge_control_output.decode().strip()}")
    except subprocess.CalledProcessError:
        print(f"Error reading Bridge Control for {bus}.")

if __name__ == "__main__":
    specific_bus_1 = "17:00.0"
    specific_bus_2 = "18:00.0"
    desired_register = "0.b"

    read_pci_register(specific_bus_1, desired_register)
    read_bridge_control(specific_bus_1)

    read_pci_register(specific_bus_2, desired_register)
    read_bridge_control(specific_bus_2)
