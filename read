import subprocess
import re

def read_lspci(bus):
    try:
        lspci_output = subprocess.check_output(["lspci", "-s", bus])
        print(f"Device {bus} information:")
        print(lspci_output.decode("utf-8"))
        print("-" * 40)  # Separator for clarity
    except subprocess.CalledProcessError:
        print(f"Error reading device {bus}.")

def read_http_status(bus):
    try:
        # Assume you want to check the status of an HTTP server running on 18:00.0
        # Replace this with the actual URL or endpoint you want to check
        url_or_endpoint = "http://example.com"  # Change to your desired URL
        http_response = subprocess.check_output(["curl", "-I", url_or_endpoint])
        status_match = re.search(r"HTTP/\d\.\d (\d{3})", http_response.decode("utf-8"))
        if status_match:
            status_code = status_match.group(1)
            print(f"HTTP status for {bus}: {status_code}")
        else:
            print(f"No valid HTTP status found for {bus}.")
    except subprocess.CalledProcessError:
        print(f"Error checking HTTP status for {bus}.")

if __name__ == "__main__":
    specific_buses = ["17:00.0", "18:00.0"]
    for bus in specific_buses:
        read_lspci(bus)
        read_http_status(bus)
